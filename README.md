# Курсовая работа № 5. База данных из HeadHunter


## Взаимодействие с пользователем

<br>

### Назначение программы
<hr>

Программа позволяет получить данные по вакансиям некоторых
(предварительно отобранных) компаний и краткие сведения 
о самих вакансиях. Данные заносятся в БД и далее можно 
сделать выборку по нескольким критериям.

<br>

### Возможные действия пользователя
<hr>

- Обновить данные в БД
- Вывести список всех компаний и количество вакансий у каждой компании
- Вывести список всех вакансий
- Вывести среднюю зарплату по вакансиям
- Вывести список всех вакансий, у которых зарплата выше средней по всем вакансиям
- Вывести список всех вакансий, в названии которых содержатся ключевое слово

<br>

### Особенности
<hr>

- Если при запуске программы БД не существует, она будет создана 
и заполнена данными. Если БД уже существует, автоматического 
обновления данных не происходит. Данные обновляются по запросу
пользователя.


- Данные выводятся в консоль в формате json.


- Для подсчета средней ЗП и сравнения вакансий по ЗП
учитывается усредненная ЗП в вакансиях. Значение формируется
по следующему принципу:

  - если для ЗП в вакансии указаны оба значения ОТ и ДО, то 
    берется среднее арифметическое этих значений;
  
  - если для ЗП в вакансии указано только одно значение ОТ
    или ДО, то берется указанное значение;
  
  - если для ЗП в вакансии не указана, среднее значение 
    не учитывается.

<br>

## Структура программы

### main.py

Создание объекта класса DBManager, 
основное взаимодействие с пользователем.

<hr>

### src /

- **db_manager.py** 

  Класс для работы с БД.
  <br>
  Создание, наполнение БД, выборки.

  <br>

- **hh_api.py**

  Получение данных с HH.

  <br>
 
- **parser_sql.py**

  Парсер файла .sql. Используется в DBManager.
  <br>
  Все запросы прописаны в config / queries.sql,
  разделены на секции согласно методам класса. 
  Секции прописаны в комментариях в квадратных скобках.
  <br>
  Парсер разделяет запросы по секциям, и возвращает словарь
  в формате {'название секции': 'текст запроса'} 

<hr>

### config /

- **database.ini**

  Данные для подключения к БД.

  В сборке файл отсутствует, т. к. содержит персональную информацию.
  Для корректной работы необходимо положить файл со следующей структурой:
  ```
  [postgresql]
  host=…
  user=…
  password=…
  port=…
  ```

  <br>

- **config.py**

  Парсит config / database.ini и возвращает словарь
  с данными для подключения к БД.
 
  <br>

- **constants.py**

  Константы для приложения:
  - список ID отобранных компаний,
  - название БД,
  - путь к .sql.
 
  <br>

- **queries.sql**

  Запросы к БД. Для корректной работы должен быть разделен
  на секции в комментариях, секции должны соответствовать 
  методам класса для работы с БД.
  
